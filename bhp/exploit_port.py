import socket
import subprocess

def identify_service(ip, port):
    try:
        result = subprocess.run(
            ['nmap', '-sV', '-p', str(port), ip],
            capture_output=True,
            text=True
        )
        print(result.stdout)
    except Exception as e:
        print(f"Erro ao identificar o serviço: {e}")

def connect_to_service(ip, port):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((ip, port))
        print(f"Conectado ao serviço na porta {port}.")
        sock.close()
    except Exception as e:
        print(f"Erro ao se conectar ao serviço: {e}")

def main():
    ip = input("Digite o IP: ")
    port = 828 #espcificamente esta

    print(f"Identificando o serviço na porta {port}...")
    identify_service(ip, port)

    print(f"Tentando se conectar ao serviço na porta {port}...")
    connect_to_service(ip, port)

if __name__ == "__main__":
    main()